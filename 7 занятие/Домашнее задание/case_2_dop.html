<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>case 2 dop</title>
</head>
<body>
    <script>
        'use strict'
        const abc = 'абвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ .,—;-';

        let text = 'ТкяфюяэкщшктруяюяткГБхГМхуякыьрВВрмкВкБрВВтхГрмкяЗДГщьщ\
        ВМкфБДукАБяГщткфБДурмкДкВрэяуякяыюрмкфтркАрВВрчщБрмкнкясркьОфщкэяья\
        фЛхмкясркАяЗГщкюрьхуыхмкясркюхкЙхуяьМВыщкяфхГЛхмкясркВкфятяьМюякшрэ\
        хЗрГхьМюЛэщкЕщшщяюяэщПэщмкщкясркАячхьртИщхмкюрыяюхЖмктяъГщкфБДукВкф\
        БДуяэкткБршуятяБлкХВьщкскяющкясркшюрьщкяфщюкАБякфБДуяуямкЗхэкяющкяВ\
        ясхююякткНГДкэщюДГДкшрэхЗрГхьМюЛмкГямкыяюхЗюямкАяфщтщьщВМксЛмкЗГякВ\
        ьДЗръкГрыкВГБрююякАяВрфщькщЁкфБДукАБяГщткфБДуркткГБхГМхыьрВВюяэктру\
        яюхкАхГхБсДБуВыяптрБИртВыяуякАяхшфрлкЯфщюкщшкющЁксЛькюхсяьМИяуякБяВ\
        ГрмкьхГкфтрфЖрГщкВхэщмкыДБЗртЛъкщкАяЗГщкЗхБюятяьяВЛъмкВкВхБЛэщмкэрь\
        хюМыщэщмкюякяуюхююЛэщкуьршрэщлкЮяВкхуяксЛькИщБяыщкВАьОВюДГмкьщЖякВы\
        ДьщВГяхокГяюыщхкуДсЛксхВАБхБЛтюякВыьрфЛтрьщВМкткырыДОпГякюруьДОмкюр\
        ВэхИьщтДОкщкфрчхкшьДОкДьЛсыДокюякьяскхуяксЛьктЛВяыкщкЁяБяИякВЕяБэщБ\
        ятрюкщкВыБрИщтрькюхсьруяБяфюякБрштщГДОкющчюООкЗрВГМкьщЖрлкЯВясхююяк\
        АБщэхГюрксЛьркткНГяэкьщЖхкхуякэхБГтрПксьхфюяВГМмкАБщфртртИрПктВхъкЕ\
        щшщяюяэщщкэяьяфяуякЗхьятхыркщшэячфхююЛъктщфмкюхВэяГБПкюркфятяьМюякы\
        БхАыяхкВьячхющхмкщктэхВГхкВкГхэкЗГяпГякВГБрВГюяхмкфякВГБрфрющПмкюхк\
        урБэяющБятртИххкВкюрЁрьМюяОкщкуБДсяОкДьЛсыяъкщкВкБхшыщэмкВрэяфятяьМ\
        юЛэкхуяктшуьПфяэлкЯюксЛькГхАьякяфхГмкткИщБяыщъмкэхБьДИхЗщъмкЗхБюЛъм\
        кыБЛГЛъкГДьДАмкщкшркюяЗМкюхкшПсмкГяуфркырыкВяВхфкхуякАБщюДчфхюксЛьк\
        тЛюхВГщкюркВтяхъкщшфБяуИхъкВАщюхктВОкВьрфяВГМкВЛБяъмкюяПсБМВыяъкБДВ\
        ВыяъкюяЗщмкыкыяГяБяъмкяЗхтщфюямксЛькюхкАБщуяГятьхюлкЮркюхэксЛькфятя\
        ьМюякИщБяыщъкщкГяьВГЛъкАьрЙксхшкБДыртяткщкВкяуБяэюЛэкырАОИяюяэмкГяЗ\
        МптпГяЗМкырыкДАяГБхсьПОГкЗрВГякфяБячюЛхмкАякшщэрэмкуфхпющсДфМкфрьхы\
        якшркуБрющЖхъмкткгтхъЖрБщщмкщьщмкюрАБщэхБмктк,хтхБюяъкЩГрьщщмкюхкБр\
        ВВЗщГЛтрПмкыяюхЗюямкАБщкНГяэкщкюркГрыщхкыяюЖЛкАякфяБяухмкырыкяГкзъф\
        ыДюхюркфяк хГхБсДБурлкЮякЗГякуяфщьяВМкщктАяьюхкДфятьхГтяБПьякткЩГрь\
        щщмкГякяыршрьяВМкюхкВятВхэкАБщуяфюЛэктк.яВВщщлкЯсьрфрГхьМкАьрЙркВкы\
        рАОИяюяэксЛькэяьяфяъкЗхьятхымкГячхкьхГкфтрфЖрГщкИхВГщкщьщкфтрфЖрГщк\
        ВхэщмкБяВГркюхэюяуякАятЛИхкВБхфюхуямкяЗхюМксхьяыДБмкуДВГятяьяВмкВяк\
        тАрьЛэщкЙхырэщкщкВкьхуяюМыяОмктяВГБхюМыяОмкАяЗГщкВятхБИхююяксхьяОкс\
        яБяфыяълкУьршркхуяксЛьщксяьМИщхмкуяьДсЛхкщкАБщВГрьМюЛхоктяктшуьПфхк\
        щЁксЛьякЗГяпГякГщЁяхмкюякГПчхьяхмкЗГяпГякАяьюяхкГяуякВГБрююяуяктЛБр\
        чхющПмкАякыяГяБяэДкюхыяГяБЛхкДурфЛтрОГкВкАхБтяуяктшуьПфркткВДсКхыГх\
        кАрфДЗДОксяьхшюМлкЬщЖякэяьяфяуякЗхьятхырксЛьямктАБяЗхэмкАБщПГюяхмкГ\
        яюыяхкщкВДЁяхмкюяксхВЖтхГюяхмкркГхАхБМкфрчхкфяВщюПкщшшПсИххлкТкБДыр\
        ЁкхуяксяьГрьВПкГяЙщъкДшхьяыкщшкВГрБяуямкАяьщюПьяуякЕДГьПБрмкшрыьОЗр\
        тИщъмкырчхГВПмктВцкхуякфяБячюяхкфяВГяПющхлкЮркюяурЁкхуяксЛьщкГяьВГя\
        АяфяИтхююЛхксрИэрыщкВкИГщсьхГрэщмкнктВцкюхкАяпБДВВыщлквхБюятяьяВЛък\
        ВяВхфкткыБЛГяэкГДьДАхктВцкНГякБршуьПфхьмкЗрВГщОкяГкюхЗхуякфхьрГМмкщ\
        мкюрыяюхЖмкВАБяВщькВкГяОкюхфхьщырГюяОкДВэхИыяъмкткыяГяБяъкГрыксхВЖх\
        БхэяююякщкюхсБхчюяктЛБрчрхГВПкщюяуфркьОфВыяхкДфятяьМВГтщхкАБщкюхДфр\
        ЗрЁксьщчюхуял';

        let resultArray = new Map();
        let maxCount = 0;
        let alpha;
        let numberCount;
        let key;
        let correctionKey;

        // Рассчет количества всех букв
        for (let i = 0; i < text.length; i++) {
            if (!resultArray.has(text[i])) {
                resultArray.set(text[i], 0);
            } 

            numberCount = resultArray.get(text[i]);
            resultArray.set(text[i], numberCount+1);
        }
        
        // Поиск максимального коилчества
        for (let result of resultArray) {
            if(result[1] > maxCount) {
                maxCount = result[1];
                alpha = result[0];
            }
        }
        
        // Удаление переноса строки '\'
        while (text.indexOf(' ') !==-1) {
            text = text.replace(' ', '');
        }

        // Перевод строки в массив для замены букв
        text = text.split('');
        // Рассчет ключа
        key = Math.abs(abc.indexOf(alpha) - abc.indexOf(' '));

        // Замена всех букв на правильные с помощью ключа
        for (let i = text.length - 1; i >= 0; i--) {
            if (( abc.indexOf(text[i]) + key ) >= abc.length) {
                // Дополнителньый ключ, если список символов идет на второй круг
                correctionKey = key - (abc.length - abc.indexOf(text[i]));
                text[i] = abc[correctionKey];
            } else {
                text[i] = abc[abc.indexOf(text[i]) + key];
            }
        }
        // Перевод текста обратно в строку
        text = text.join('');
        console.log(text);
    </script>
</body>
</html>